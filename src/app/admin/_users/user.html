<div class="modal-content gameBg" *ngIf="userInfo">

  <div class="header">
    <button matTooltip="Close" type="button" class="close pull-right" (click)="closeUser()">
      <mat-icon>close</mat-icon>
    </button>
    <h4>{{name}}</h4>
  </div>

  <div class="modal-body gameBox">

    <mat-tab-group [selectedIndex]="selectedTab" (selectedIndexChange)="onLinkClick($event)" class="gameTabBl">

      <mat-tab label="{{ 'Users' | translate }}">
        <p>&nbsp;</p>
        <mat-select *ngIf="type != 1" placeholder="Choose Option" [(ngModel)]="selectedValueNew" class="full-width">
          <mat-option value="">{{ 'Choose Options' | translate }}</mat-option>
          <mat-option value="newUser">{{ 'New Player' | translate }}</mat-option>
          <mat-option value="newDealer">{{ 'New Dealer' | translate }}</mat-option>
          <mat-option *ngIf="parentUser != 'root'" value="edit">{{ 'Edit' | translate }}</mat-option>
        </mat-select>

        <h3 *ngIf="type == 1">{{ 'Change Password' | translate }}</h3>

        <!-- Edit Player -->
        <div *ngIf="selectedValueNew == 'edit'">
          <form [formGroup]="editUserForm" (ngSubmit)=onSubmitEditUserForm(editUserForm.value) novalidate>
            <div class="inner">

              <!-- User -->
              <div *ngIf="type == 1" class="row">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                  <mat-form-field class="full-width">
                    <input type="password" matInput placeholder="{{ 'Password' | translate }}" formControlName="mod_newdealer_pwd">
                  </mat-form-field>
                </div>
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                  <button type="submit" [disabled]="!editUserForm.valid || loading" class="btn btn-success full-width" mat-raised-button>{{ 'Save' | translate }}
                    <img *ngIf="loading" class="loading" src="../../assets/images/loader.gif" />
                  </button>
                </div>
              </div>

              <!-- Deler -->
              <div *ngIf="type != 1" class="row">
                <div class="col-lg-5 col-md-5 col-sm-5 col-xs-5 widPad">
                  <mat-form-field class="full-width">
                    <input type="password" matInput placeholder="{{ 'Password' | translate }}" formControlName="mod_newdealer_pwd">
                  </mat-form-field>
                </div>
                <div class="col-lg-5 col-md-5 col-sm-5 col-xs-5">
                  <mat-form-field class="full-width">
                    <input readonly type="number" matInput placeholder="{{ 'Giving Share' | translate }}" formControlName="mod_newdealer_share">
                  </mat-form-field>
                </div>
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                  <button type="submit" [disabled]="!editUserForm.valid || loading" class="btn btn-success full-width" mat-raised-button>{{ 'Save' | translate }}
                    <img *ngIf="loading" class="loading" src="../../assets/images/loader.gif" />
                  </button>
                </div>
              </div>

            </div>
          </form>
        </div>

        <!-- New Player -->
        <div *ngIf="selectedValueNew == 'newUser'">
          <form [formGroup]="newUserForm" (ngSubmit)=onSubmitNewUserForm(newUserForm.value) novalidate>
            <div class="inner">
              <div class="row">

                <div class="col-lg-5 col-md-5 col-sm-5 col-xs-5 widPad">
                  <mat-form-field class="full-width">
                    <input type="text" matInput placeholder="{{ 'Name' | translate }}" formControlName="mod_newdealer_name">
                  </mat-form-field>
                </div>

                <div class="col-lg-5 col-md-5 col-sm-5 col-xs-5">
                  <mat-form-field class="full-width">
                    <input type="text" matInput placeholder="{{ 'Login Id' | translate }}" formControlName="mod_newdealer_uname">
                  </mat-form-field>
                </div>

                <div class="col-lg-5 col-md-5 col-sm-5 col-xs-5 widPad">
                  <mat-form-field class="full-width">
                    <input type="text" matInput placeholder="{{ 'Password' | translate }}" formControlName="mod_newdealer_pwd">
                  </mat-form-field>
                </div>

                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                  <button type="submit" [disabled]="!newUserForm.valid || loading" class="btn btn-success full-width" mat-raised-button>{{ 'Add Player' | translate }}
                    <img *ngIf="loading" class="loading" src="../../assets/images/loader.gif" />
                  </button>
                </div>
              </div>
            </div>
          </form>
        </div>

        <!-- New Dealer -->
        <div *ngIf="selectedValueNew == 'newDealer'">
          <form [formGroup]="newDealerForm" (ngSubmit)=onSubmitNewDealerForm(newDealerForm.value) novalidate>
            <div class="inner">
              <div class="row">
                <div class="col-lg-5 col-md-5 col-sm-5 col-xs-5 widPad">
                  <mat-form-field class="full-width">
                    <input type="text" matInput placeholder="{{ 'Name' | translate }}" formControlName="mod_newdealer_name">
                  </mat-form-field>
                </div>

                <div class="col-lg-5 col-md-5 col-sm-5 col-xs-5">
                  <mat-form-field class="full-width">
                    <input type="text" matInput placeholder="{{ 'Login Id' | translate }}" formControlName="mod_newdealer_uname">
                  </mat-form-field>
                </div>

                <div class="col-lg-5 col-md-5 col-sm-5 col-xs-5 widPad">
                  <mat-form-field class="full-width">
                    <input type="text" matInput placeholder="{{ 'Password' | translate }}" formControlName="mod_newdealer_pwd">
                  </mat-form-field>
                </div>

                <div *ngIf="userInfo.default_percent == null" class="col-lg-5 col-md-5 col-sm-5 col-xs-5">
                  <mat-form-field class="full-width">
                    <input type="number" matInput placeholder="{{ 'Giving Rate' | translate }}" formControlName="mod_newdealer_share">
                  </mat-form-field>
                </div>

                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                  <button type="submit" [disabled]="!newDealerForm.valid || loading" class="btn btn-success full-width" mat-raised-button>{{ 'Add Dealer' | translate }}
                    <img *ngIf="loading" class="loading" src="../../assets/images/loader.gif" />
                  </button>
                </div>
              </div>
            </div>
          </form>
        </div>

        <div class="bk-blnsCredit">
          <p>
            <strong>Name:</strong>
            <span class="">{{userInfo.name}}</span>
          </p>
          <p>
            <strong>Received from parent:</strong>
            <span class="">{{((userInfo.creditparent) - 0 + (userInfo.depositparent - 0))| number: '1.2-2' }}</span>
          </p>
          <p>
            <strong>Available Balance:</strong>
            <span class="">{{userInfo.balance|number: '1.2-2'}}</span>
          </p>
          <p *ngIf="userInfo.type != 1">
            <strong>Available Balance in childs:</strong>
            <span class="">{{((userInfo.childsExp) - 0 + (userInfo.childsBal - 0))|number: '1.2-2'}}</span>
          </p>
          <p>
            <strong>Profit/Loss:</strong>
            <span class="">{{userInfo.profitloss|number: '1.2-2'}}</span>
          </p>
          <p *ngIf="userInfo.type == 1">
            <strong>Current Exposure:</strong>
            <span class="">{{userInfo.exposure|number: '1.2-2'}}</span>
          </p>
          <p>
            <strong>Net Credit(Parent):</strong>
            <span class="">{{userInfo.creditparent|number: '1.2-2'}}</span>
          </p>
          <p *ngIf="userInfo.type != 1">
            <strong>Net Credit(Chlids):</strong>
            <span class="">{{userInfo.creditchild|number: '1.2-2'}}</span>
          </p>
          <p>
            <strong>Net Settling(Parent):</strong>
            <span class="">{{userInfo.depositparent|number: '1.2-2'}}</span>
          </p>
          <p *ngIf="userInfo.type != 1">
            <strong>Net Settling(Chlids):</strong>
            <span class="">{{userInfo.depositchild|number: '1.2-2'}}</span>
          </p>
        </div>


        <p *ngIf="parentUser != 'root'" class="togelBets"> {{status == 0 ? 'Suspend' : 'Suspend'}}
          <span class="sus">
            <mat-slide-toggle [checked]="suspendStatus" (click)="suspend()"></mat-slide-toggle>
          </span>
        </p>

      </mat-tab>

      <mat-tab *ngIf="(getAccess || parentUser != 'root')" label="{{ 'Balance' | translate }}">
        <p>&nbsp;</p>
        <mat-select placeholder="Choose Option" (change)="transactionEvent()" [(ngModel)]="selectedValueBalance" class="full-width">
          <mat-option value="crediIn">{{ 'Credit In' | translate }}</mat-option>
          <mat-option value="creditOut">{{ 'Credit Out' | translate }}</mat-option>
        </mat-select>

        <!-- Credi In -->
        <div *ngIf="selectedValueBalance == 'crediIn'">
          <form [formGroup]="crediInForm" (ngSubmit)=onSubmitCrediInForm(crediInForm.value) novalidate>
            <div class="inner">
              <div class="row">

                <div class="col-lg-5 col-md-5 col-sm-5 col-xs-5 widPad">
                  <mat-form-field class="full-width">
                    <input type="number" matInput placeholder="{{ 'Amount' | translate }}" formControlName="mod_user_deposit_amt">
                  </mat-form-field>
                </div>

                <div class="col-lg-5 col-md-5 col-sm-5 col-xs-5">
                  <mat-form-field class="full-width">
                    <input type="text" matInput placeholder="{{ 'Remarks' | translate }}" formControlName="mod_user_deposit_remark">
                  </mat-form-field>
                </div>

                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                  <button type="submit" [disabled]="!crediInForm.valid || loading" class="btn btn-success full-width" mat-raised-button>{{ 'Credit In' | translate }}
                    <img *ngIf="loading" class="loading" src="../../assets/images/loader.gif" />
                  </button>
                </div>
              </div>
            </div>
          </form>
        </div>

        <!-- Credit Out -->
        <div *ngIf="selectedValueBalance == 'creditOut'">
          <form [formGroup]="divideForm" (ngSubmit)=onSubmitDivideForm(divideForm.value) novalidate>
            <div class="inner">
              <div class="row">

                <div class="col-lg-5 col-md-5 col-sm-5 col-xs-5 widPad">
                  <mat-form-field class="full-width">
                    <input type="number" matInput placeholder="{{ 'Amount' | translate }}" formControlName="mod_user_withdraw_amt">
                  </mat-form-field>
                </div>

                <div class="col-lg-5 col-md-5 col-sm-5 col-xs-5">
                  <mat-form-field class="full-width">
                    <input type="text" matInput placeholder="{{ 'Remarks' | translate }}" formControlName="mod_user_withdral_remark">
                  </mat-form-field>
                </div>

                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                  <button type="submit" [disabled]="!divideForm.valid || loading" class="btn btn-success full-width" mat-raised-button>{{ 'Credit Out' | translate }}
                    <img *ngIf="loading" class="loading" src="../../assets/images/loader.gif" />
                  </button>
                </div>
              </div>
            </div>
          </form>
        </div>

      </mat-tab>

      <mat-tab *ngIf="getAccess" label="{{ 'Pref' | translate }}">
        <form [formGroup]="settingsForm" (ngSubmit)=onSubmitSettingsForm(settingsForm.value) novalidate>
          <div class="inner dropList">
            <div class="row">

              <!-- inhDesible -->
              <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <ng-select [options]="allOptions" (selected)="changeSettingsForm(settingsForm.value)" formControlName="mod_settings_opt"
                  class="full-width" placeholder="{{ 'Choose Options' | translate }}"></ng-select>
              </div>

              <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <ng-select [options]="allGames" (selected)="changeSettingsForm(settingsForm.value)" formControlName="mod_settings_gid" class="full-width"
                  placeholder="{{ 'Choose Games' | translate }}"></ng-select>
              </div>

              <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">

                <div *ngIf="settingsForm.controls['mod_settings_opt'].value == 'match_amt'">
                  <mat-select placeholder="Choose Option" formControlName="mod_settings_val" class="full-width">
                    <mat-option value="">{{ 'Choose Options' | translate }}</mat-option>
                    <mat-option value="1">{{ 'User Stake' | translate }}</mat-option>
                    <mat-option value="2">{{ 'Exchange Stake' | translate }}</mat-option>
                  </mat-select>
                </div>

                <div *ngIf="settingsForm.controls['mod_settings_opt'].value == 'unmatched_bets'">
                  <mat-select placeholder="Choose Option" formControlName="mod_settings_val" class="full-width">
                    <mat-option value="">{{ 'Choose Options' | translate }}</mat-option>
                    <mat-option value="1">{{ 'Unlocked' | translate }}</mat-option>
                    <mat-option value="2">{{ 'Locked' | translate }}</mat-option>
                  </mat-select>
                </div>

                <div *ngIf="settingsForm.controls['mod_settings_opt'].value == 'system_status'">
                  <mat-select placeholder="Choose Option" formControlName="mod_settings_val" class="full-width">
                    <mat-option value="">{{ 'Choose Options' | translate }}</mat-option>
                    <mat-option value="1">{{ 'Unlocked (accept bets)' | translate }}</mat-option>
                    <mat-option value="5">{{ 'Locked' | translate }}</mat-option>
                  </mat-select>
                </div>

                <div *ngIf="settingsForm.controls['mod_settings_opt'].value != 'unmatched_bets' && settingsForm.controls['mod_settings_opt'].value != 'system_status' && settingsForm.controls['mod_settings_opt'].value != 'match_amt'">
                  <mat-form-field class="full-width">
                    <input [readonly]="inhDesible" type="text" matInput placeholder="{{ 'Value' | translate }}" formControlName="mod_settings_val">
                  </mat-form-field>
                </div>

              </div>

              <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <mat-checkbox class="example-margin" (click)="changeInhDesible()" formControlName="mod_settings_inh">{{ 'Inherit from parent' | translate }}</mat-checkbox>
              </div>

              <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <button type="submit" [disabled]="!settingsForm.valid || loading" class="btn btn-success full-width" mat-raised-button>{{ 'Update' | translate }}
                  <img *ngIf="loading" class="loading" src="../../assets/images/loader.gif" />
                </button>
              </div>

              <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <div *ngIf="settingsForm.controls['mod_settings_opt']?.value == 'wincom'">{{ '% of commission charge on winning!' | translate }}</div>
                <div *ngIf="settingsForm.controls['mod_settings_opt']?.value == 'min_stake'">{{ 'Minimum stake size of the bet!' | translate }}</div>
                <div *ngIf="settingsForm.controls['mod_settings_opt']?.value == 'max_stake'">{{ 'Maximum stake size of the bet!' | translate }}</div>
                <div *ngIf="settingsForm.controls['mod_settings_opt']?.value == 'max_profit'">{{ 'Maximum profit allowed in any runner!' | translate }}</div>
                <div *ngIf="settingsForm.controls['mod_settings_opt']?.value == 'before_inplay'">{{ 'Maximum profit allowed in any runner before inplay!' | translate }}</div>
                <div *ngIf="settingsForm.controls['mod_settings_opt']?.value == 'bet_delay'">{{ 'Not advisable below 2 seconds!' | translate }}</div>
                <div *ngIf="settingsForm.controls['mod_settings_opt']?.value == 'match_amt'">{{ 'User stake = User entered stake! Exchange stake = Stake available at exchange!' | translate }}</div>
                <div *ngIf="settingsForm.controls['mod_settings_opt']?.value == 'multiple_vol'">{{ 'Multiple volume. Value * Exchange stake!' | translate }}</div>
                <div *ngIf="settingsForm.controls['mod_settings_opt']?.value == 'ticker'">{{ 'Use ! between two Msg. Like-> Msg1.!Msg2' | translate }}</div>
                <div *ngIf="settingsForm.controls['mod_settings_opt']?.value == 'unmatched_bets'">{{ 'When Lock Only Partial Unmatched betting will be allowed.!' | translate }}</div>
                <div *ngIf="settingsForm.controls['mod_settings_opt']?.value == 'system_status'">{{ 'When Lock betting will be stopped.!' | translate }}</div>
              </div>


            </div>
          </div>
        </form>
      </mat-tab>

      <mat-tab *ngIf="(getAccess || parentUser != 'root')" label="{{ 'Settlement' | translate }}">
        <p>&nbsp;</p>
        <mat-select placeholder="Choose Option" (change)="transactionEvent()" [(ngModel)]="selectedValueTransaction" class="full-width">
          <mat-option value="deposit">{{ 'Deposit' | translate }}</mat-option>
          <mat-option value="withdraw">{{ 'Withdraw' | translate }}</mat-option>
        </mat-select>

        <!-- Deposit -->
        <div *ngIf="selectedValueTransaction === 'deposit'">
          <form [formGroup]="depositForm" (ngSubmit)=onSubmitDepositForm(depositForm.value) novalidate>
            <div class="inner">
              <div class="row">

                <div class="col-lg-5 col-md-5 col-sm-5 col-xs-5 widPad">
                  <mat-form-field class="full-width">
                    <input type="number" matInput placeholder="{{ 'Amount' | translate }}" formControlName="mod_user_deposit_amt">
                  </mat-form-field>
                </div>

                <div class="col-lg-5 col-md-5 col-sm-5 col-xs-5">
                  <mat-form-field class="full-width">
                    <input type="text" matInput placeholder="{{ 'Remarks' | translate }}" formControlName="mod_user_deposit_remark">
                  </mat-form-field>
                </div>

                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">

                  <ng-select [allowClear]="true" [options]="cashDepositList" formControlName="mod_user_cash_deposit" class="full-width" placeholder="Choose Option"></ng-select>
                  <span class="errorMessage">Select any or default settlement a/c</span>
                </div>

                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                  <button type="submit" [disabled]="!depositForm.valid || loading" class="btn btn-success full-width depositButt" mat-raised-button>{{ 'Deposit' | translate }}
                    <img *ngIf="loading" class="loading" src="../../assets/images/loader.gif" />
                  </button>
                </div>
              </div>
            </div>
          </form>
        </div>

        <!-- Withdraw -->
        <div *ngIf="selectedValueTransaction === 'withdraw'">
          <form [formGroup]="withdrawForm" (ngSubmit)=onSubmitWithdrawForm(withdrawForm.value) novalidate>
            <div class="inner">
              <div class="row">

                <div class="col-lg-5 col-md-5 col-sm-5 col-xs-5 widPad">
                  <mat-form-field class="full-width">
                    <input type="number" matInput placeholder="{{ 'Amount' | translate }}" formControlName="mod_user_withdraw_amt">
                  </mat-form-field>
                </div>

                <div class="col-lg-5 col-md-5 col-sm-5 col-xs-5">
                  <mat-form-field class="full-width">
                    <input type="text" matInput placeholder="{{ 'Remarks' | translate }}" formControlName="mod_user_withdral_remark">
                  </mat-form-field>
                </div>

                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">

                  <ng-select [options]="cashwithdrawList" formControlName="mod_user_cash_withdraw" class="full-width" placeholder="Choose Option"></ng-select>
                  <span class="errorMessage">Select any or default settlement a/c</span>
                </div>

                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                  <button type="submit" [disabled]="!withdrawForm.valid || loading" class="btn btn-success withdrawButt full-width" mat-raised-button>{{ 'Withdraw' | translate }}
                    <img *ngIf="loading" class="loading" src="../../assets/images/loader.gif" />
                  </button>
                </div>
              </div>
            </div>
          </form>
        </div>
      </mat-tab>

      <mat-tab *ngIf="(getAccess || parentUser != 'root')" label="{{ 'Report' | translate }}">
        <app-userreport [uid]="userInfo.user_id" [uname]="userInfo.username"></app-userreport>
      </mat-tab>

      <mat-tab label="{{ 'Cash A/c`s' | translate }}">
        <form [formGroup]="newCashForm" (ngSubmit)=onSubmitnewCashForm(newCashForm.value) novalidate>
          <div class="inner">
            <div class="row">

              <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <mat-form-field class="full-width">
                  <input type="text" matInput placeholder="{{ 'Name' | translate }}" formControlName="cash_user_name">
                </mat-form-field>
              </div>

              <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <button type="submit" [disabled]="!newCashForm.valid || loading" class="btn btn-success full-width" mat-raised-button>{{ 'Add Player' | translate }}
                  <img *ngIf="loading" class="loading" src="../../assets/images/loader.gif" />
                </button>
              </div>
            </div>
          </div>
        </form>
        <div class="bk-blnsCredit" *ngIf="(getAccess || parentUser != 'root')">
          <div *ngFor="let item of cashUserList">
            <p>
              <span class="wd" (click)="openModal(templateBalance); parentId=userInfo.user_id; userId=item.user_id; userName=item.name; type='withdraw'">W</span>
              <span class="wd" (click)="openModal(templateBalance); parentId=userInfo.user_id; userId=item.user_id; userName=item.name; type='deposit'">D</span>
              <span class="wd" (click)="cashUserListDetails(item.user_id)">V</span>
              <strong>{{item.name}}:</strong>
              <span class="valueTxt">{{item.balance}}</span>
            </p>
            <div class="cashUserDetails" *ngIf="cashUserDetailsId === item.user_id && cashUserDetails.length !=0">
              <table border="0" cellpadding="0" cellspacing="0" width="100%">
                <thead>
                  <tr>
                    <th width="35%">Time</th>
                    <th width="35%">Remark</th>
                    <th width="10%">Amount</th>
                    <th width="20%">Con Amount</th>
                  </tr>
                </thead>
              </table>
              <div id="style-6" class="bookDetails scrollbar">
                <table border="0" cellpadding="0" cellspacing="0" width="100%">
                  <tbody>
                    <tr *ngFor="let item of cashUserDetails">
                      <td width="35%">{{item.txn_time}}</td>
                      <td width="35%">{{item.remark}}</td>
                      <td class="text-right {{item.amount >= 0 ? 'positive' : 'negative'}}" width="10%">{{item.amount}}</td>
                      <td class="text-right {{item.con_amount >= 0 ? 'positive' : 'negative'}}" width="20%">{{item.con_amount}}</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <!-- Admin Option Template -->
        <ng-template #templateBalance>
          <div class="header">
            <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
              <mat-icon aria-hidden="true">close</mat-icon>
            </button>
            <h4>{{ 'Settlement' | translate }} - {{userName}}</h4>
          </div>
          <div class="modal-body optionSection">
            <admin-balance [userId]="userId" [type]="type" [parentId]="parentId"></admin-balance>
          </div>
        </ng-template>

      </mat-tab>

    </mat-tab-group>

  </div>
</div>