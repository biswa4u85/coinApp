<div class="row">
  <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
    <mat-select placeholder="Choose Option" [(ngModel)]="selectedValue" (change)="loadReport()" class="full-width">
      <mat-option value="">{{ 'Choose Option' | translate }}</mat-option>
      <mat-option value="pl">{{ 'P/L Report' | translate }}</mat-option>
      <mat-option value="td">{{ 'TXN Details' | translate }}</mat-option>
      <mat-option value="as">{{ 'Running Balance' | translate }}</mat-option>
      <mat-option value="bets">{{ 'Bets' | translate }}</mat-option>
      <mat-option value="acst">{{ 'Account Status' | translate }}</mat-option>
      <mat-option value="credit_adjust">{{ 'Balance Sheet' | translate }}</mat-option>
    </mat-select>
  </div>
  <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 reportdtPic ReportArea">

    <!-- PL Report -->
    <div class="inner ptReport active" *ngIf="selectedValue == 'pl'">

      <ng-template #customCellTemplate let-day="day" let-locale="locale">
        <div *ngIf="day.events[0]" class="cal-cell-top {{(day.events[0].title < 0) ? 'positive' : 'negative'}}">
          <span class="cal-day-number">{{ day.date | calendarDate:'monthViewDayNumber':locale }}</span>
          <span *ngIf="day.events[0].title < 0" class="cal-day-badge">{{ (-1*day.events[0].title).toFixed(2)}}</span>
          <span *ngIf="day.events[0].title >= 0" class="cal-day-badge">{{ (day.events[0].title).toFixed(2)}}</span>
        </div>

        <div *ngIf="!day.events[0]" class="cal-cell-top">
          <span class="cal-day-number">{{ day.date | calendarDate:'monthViewDayNumber':locale }}</span>
        </div>

      </ng-template>

      <div class="row text-center frReport">
        <div class="col-lg-4 col-md-4 col-md-offset-4 col-sm-4 col-xs-6 totalAmount">
          <span class="dateTxt">{{ viewDate | calendarDate:(view + 'ViewTitle'):'en' }}</span>
          <span *ngIf="plReportTotal < 0" class="totalPrice">Total :
            <span class="positive">{{-1*plReportTotal.toFixed(2)}}</span>
          </span>
          <span *ngIf="plReportTotal >= 0" class="totalPrice">Total :
            <span class="negative">{{(plReportTotal).toFixed(2)}}</span>
          </span>

        </div>
        <div class="col-lg-4 col-md-4 col-sm-4 col-xs-6 tabletab">
          <div class="btn-group mobLeft pull-right">
            <div class="btn btn-primary" mwlCalendarPreviousView [view]="view" (click)="onSubmitReportPlNextPre('pl')" [(viewDate)]="viewDate">
              Previous
            </div>
            <div class="btn btn-outline-secondary" mwlCalendarToday (click)="onSubmitReportPl('pl')" [(viewDate)]="viewDate">
              Today
            </div>
            <div *ngIf="removeNext" class="btn btn-primary" mwlCalendarNextView [view]="view" (click)="onSubmitReportPlNextPre('pl')"
              [(viewDate)]="viewDate">
              Next
            </div>
          </div>
        </div>
      </div>
      <div class="reporttable" [ngSwitch]="view">
        <mwl-calendar-month-view *ngSwitchCase="'month'" [cellTemplate]="customCellTemplate" [viewDate]="viewDate" [events]="events"
          [refresh]="refresh" [activeDayIsOpen]="activeDayIsOpen" (dayClicked)="dayClicked($event.day);">
        </mwl-calendar-month-view>
      </div>

    </div>

    <!-- TXN Details -->
    <div class="inner ptReport active" *ngIf="selectedValue == 'td'">
      <ng-template #customCellTemplate let-day="day" let-locale="locale">
        <div *ngIf="day.events[0]" class="cal-cell-top {{(day.events[0].title >= 0) ? 'positive' : 'negative'}}">
          <span class="cal-day-number">{{ day.date | calendarDate:'monthViewDayNumber':locale }}</span>
          <span *ngIf="day.events[0].title >= 0" class="cal-day-badge">{{ (day.events[0].title).toFixed(2)}}</span>
          <span *ngIf="day.events[0].title < 0" class="cal-day-badge">{{ (-1*day.events[0].title).toFixed(2)}}</span>
        </div>

        <div *ngIf="!day.events[0]" class="cal-cell-top">
          <span class="cal-day-number">{{ day.date | calendarDate:'monthViewDayNumber':locale }}</span>
        </div>

      </ng-template>

      <div class="row text-center frReport">
        <div class="col-lg-4 col-md-4 col-md-offset-4 col-sm-4 col-xs-6 totalAmount">
          <span class="dateTxt">{{ viewDate | calendarDate:(view + 'ViewTitle'):'en' }}</span>
          <span *ngIf="plReportTotal >= 0" class="totalPrice">Total :
            <span class="positive">{{plReportTotal.toFixed(2)}}</span>
          </span>
          <span *ngIf="plReportTotal < 0" class="totalPrice">Total :
            <span class="negative">{{(-1*plReportTotal).toFixed(2)}}</span>
          </span>

        </div>
        <div class="col-lg-4 col-md-4 col-sm-4 col-xs-6 tabletab">
          <div class="btn-group mobLeft pull-right">
            <div class="btn btn-primary" mwlCalendarPreviousView [view]="view" (click)="onSubmitReportPlNextPre('txn')" [(viewDate)]="viewDate">
              Previous
            </div>
            <div class="btn btn-outline-secondary" mwlCalendarToday (click)="onSubmitReportTxn('txn')" [(viewDate)]="viewDate">
              Today
            </div>
            <div *ngIf="removeNext" class="btn btn-primary" mwlCalendarNextView [view]="view" (click)="onSubmitReportPlNextPre('txn')"
              [(viewDate)]="viewDate">
              Next
            </div>
          </div>
        </div>
      </div>
      <div class="reporttable" [ngSwitch]="view">
        <mwl-calendar-month-view *ngSwitchCase="'month'" [cellTemplate]="customCellTemplate" [viewDate]="viewDate" [events]="events"
          [refresh]="refresh" [activeDayIsOpen]="activeDayIsOpen" (dayClicked)="dayClicked($event.day);">
        </mwl-calendar-month-view>
      </div>

    </div>

    <!-- Running Balance -->
    <div class="inner ptReport active" *ngIf="selectedValue == 'as'">
      <ng-template #customCellTemplate let-day="day" let-locale="locale">
        <div *ngIf="day.events[0]" class="cal-cell-top">
          <span class="cal-day-number">{{ day.date | calendarDate:'monthViewDayNumber':locale }}</span>
          <span class="cal-day-open">Opening</span>
          <span class="cal-day-badgeUp">{{ (day.events[0].meta[0].balance)}}</span>
          <span class="cal-day-close">Closing</span>
          <span class="cal-day-badge">{{(day.events[0].title)}}</span>
        </div>

        <div *ngIf="!day.events[0]" class="cal-cell-top">
          <span class="cal-day-number">{{ day.date | calendarDate:'monthViewDayNumber':locale }}</span>
        </div>

      </ng-template>

      <div class="row text-center frReport">
        <div class="col-lg-4 col-md-4 col-md-offset-4 col-sm-4 col-xs-6 totalAmount">
          <span class="dateTxt">{{ viewDate | calendarDate:(view + 'ViewTitle'):'en' }}</span>
          <span *ngIf="plReportTotal >= 0" class="totalPrice">Current Coin :
            <span class="positive">{{plReportTotal.toFixed(2)}}</span>
          </span>
          <span *ngIf="plReportTotal < 0" class="totalPrice">Current Coin :
            <span class="negative">{{(plReportTotal).toFixed(2)}}</span>
          </span>

        </div>
        <div class="col-lg-4 col-md-4 col-sm-4 col-xs-6 tabletab">
          <div class="btn-group mobLeft pull-right">
            <div class="btn btn-primary" mwlCalendarPreviousView [view]="view" [(viewDate)]="viewDate">
              Previous
            </div>
            <div class="btn btn-outline-secondary" mwlCalendarToday [(viewDate)]="viewDate">
              Today
            </div>
            <div *ngIf="removeNext" class="btn btn-primary" mwlCalendarNextView [view]="view" [(viewDate)]="viewDate">
              Next
            </div>
          </div>
        </div>
      </div>
      <div class="reporttable" [ngSwitch]="view">
        <mwl-calendar-month-view *ngSwitchCase="'month'" [cellTemplate]="customCellTemplate" [viewDate]="viewDate" [events]="events"
          [refresh]="refresh" [activeDayIsOpen]="activeDayIsOpen" (dayClicked)="dayClicked($event.day);">
        </mwl-calendar-month-view>
      </div>

    </div>

    <!-- Bets -->
    <div class="inner" *ngIf="selectedValue == 'bets'">
      <form [formGroup]="plReportForm" (ngSubmit)=onSubmitBetReport(plReportForm.value) novalidate>

        <div class="row">

          <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
            <ng-select [options]="allGames" formControlName="gid" class="full-width" placeholder="{{ 'Choose Games' | translate }}"></ng-select>
          </div>

          <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12 gameDrop">
            <ng-select [options]="allUsers" formControlName="uid" class="full-width" placeholder="{{ 'Choose Users' | translate }}"></ng-select>
          </div>

          <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
            <mat-select placeholder="Choose Category" formControlName="game_type" class="full-width">
              <mat-option value="0">{{ 'ALL' | translate }} </mat-option>
              <mat-option value="1">{{ 'Soccer' | translate }}</mat-option>
              <mat-option value="4">{{ 'Cricket' | translate }}</mat-option>
              <mat-option value="2">{{ 'Tennis' | translate }}</mat-option>
              <mat-option value="7">{{ 'Horse Race' | translate }}</mat-option>
              <mat-option value="8">{{ 'All Fancy' | translate }}</mat-option>
              <mat-option value="9">{{ 'Score Fancy' | translate }}</mat-option>
              <mat-option value="10">{{ 'Range Fancy' | translate }}</mat-option>
              <mat-option value="11">{{ 'Odd/Even Fancy' | translate }}</mat-option>
            </mat-select>
          </div>
        </div>

        <div class="row">

          <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
            <ng2-datepicker [options]="optionsFrom" placeholder="Choose a date" formControlName="from"></ng2-datepicker>
            <mat-checkbox class="example-margin" formControlName="fromBegining">{{ 'From begining' | translate }}</mat-checkbox>
          </div>

          <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
            <ng2-datepicker [options]="optionsTo" placeholder="Choose a date" formControlName="to"></ng2-datepicker>
            <mat-checkbox class="example-margin" formControlName="tillNow">{{ 'Till now' | translate }}</mat-checkbox>
          </div>

          <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
            <button type="submit" [disabled]="!plReportForm.valid || loading" class="btn btn-success full-width" mat-raised-button>{{ 'Generate Report' | translate }}
              <img *ngIf="loading" class="loading" src="../../assets/images/loader.gif" />
            </button>
          </div>
          <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 dtTable">

            <ng2-smart-table [settings]="reportSettings" [source]="betReport"></ng2-smart-table>

          </div>
        </div>
      </form>
    </div>

    <!-- Account Status -->
    <div class="inner" *ngIf="selectedValue == 'acst'">
      <div class="row">

        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 dtTable">

          <ng2-smart-table [settings]="statusSettings" [source]="statusReport"></ng2-smart-table>

        </div>
      </div>

    </div>

    <!-- Balance Sheet -->
    <div class="inner" *ngIf="selectedValue == 'credit_adjust'">


      <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 blanceReport">
          <table border="0" cellpadding="0" cellspacing="0" width="100%" *ngIf="balanceReport">
            <thead>
              <tr>
                <th width="35%">{{ 'User Name' | translate }}</th>
                <th width="15%">{{ 'Credit' | translate }}</th>
                <th width="35%">{{ 'User Name' | translate }}</th>
                <th width="15%">{{ 'Debit' | translate }}</th>
              </tr>
            </thead>
          </table>
        </div>

        <div id="style-6" class="col-lg-12 col-md-12 col-sm-12 col-xs-12 blanceReport scrollbar adReport">
          <table border="0" cellpadding="0" cellspacing="0" width="100%" *ngIf="balanceReport">
            <tbody>
              <tr class="{{(i%2) ? 'odd' : 'even'}}" *ngFor="let item of balanceReport[balanceReport.totalCal]; let i = index;">
                <td width="35%">
                  <span *ngIf="balanceReport.Credit[i] && balanceReport.Credit[i].parent_id != 1" class="pull-right" matTooltip="Withdraw"
                    (click)="openModal(templateBalance); parentId=balanceReport.Credit[i].parent_id; userId=balanceReport.Credit[i].user_id; userName=balanceReport.Credit[i].username; type='withdraw'">W</span> {{balanceReport.Credit[i] ? balanceReport.Credit[i].username : ''}}</td>
                <td width="15%" class="text-right positive">{{balanceReport.Credit[i] ? balanceReport.Credit[i].amount.toFixed(2) : ''}}
                </td>
                <td width="35%">
                  <span *ngIf="balanceReport.Debit[i] && balanceReport.Debit[i].parent_id != 1" class="pull-right" matTooltip="Deposit" (click)="openModal(templateBalance); parentId=balanceReport.Debit[i].parent_id; userId=balanceReport.Debit[i].user_id; userName=balanceReport.Debit[i].username; type='deposit'">D</span> {{balanceReport.Debit[i] ? balanceReport.Debit[i].username : ''}}</td>
                <td width="15%" class="text-right negative">{{balanceReport.Debit[i] ? balanceReport.Debit[i].amount.toFixed(2) : ''}}</td>
              </tr>
              <tr>
                <td width="35%">Total</td>
                <td width="15%" class="text-right positive">{{balanceReport.Tcredit.toFixed(2)}}</td>
                <td width="35%">Total</td>
                <td width="15%" class="text-right negative">{{balanceReport.Tdebit.toFixed(2)}}</td>
              </tr>
            </tbody>
          </table>

        </div>
      </div>

      <!-- Admin Option Template -->
      <ng-template #templateBalance>
        <div class="header">
          <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide(); onSubmitBalanceReport(plReportForm.value)">
            <mat-icon aria-hidden="true">close</mat-icon>
          </button>
          <h4>{{ 'Settlement' | translate }} - {{userName}}</h4>
        </div>
        <div class="modal-body optionSection">
          <admin-balance [userId]="userId" [type]="type" [parentId]="parentId"></admin-balance>
        </div>
      </ng-template>



    </div>

  </div>

</div>